[{"path":"/CONTRIBUTING.html","id":"contributing-to-vcfppr","dir":"","previous_headings":"","what":"Contributing to vcfppR","title":"NA","text":"Please see file Contributing details report issue: Minimally Complete () Verifiable Example (MCVE) helps lot; submit pull request: post issue first, get consensus ; follow (informal) coding style: simply files invent new style; nice NEWS.Rd","code":""},{"path":"/PULL_REQUEST_TEMPLATE.html","id":"pull-request-template-for-rcpp","dir":"","previous_headings":"","what":"Pull Request Template for Rcpp","title":"NA","text":"Please explain changes want apply Rcpp, preferably issue ticket create pull request. See file Contributing templates details.","code":""},{"path":"/PULL_REQUEST_TEMPLATE.html","id":"checklist","dir":"","previous_headings":"Pull Request Template for Rcpp","what":"Checklist","title":"NA","text":"Code compiles correctly R CMD check still passes tests Preferably, new tests added fail without change Document changes file ChangeLog","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Assess the concordance between VCFs","text":"benchmarking, ’s often need calculate concordance rate test set truth set. truth VCF file, always true genotypes GT otherwise can’t validate test VCF. test VCF may variant caller genotype imputation program, format can variable, e.g GP, DS GT. Hence, article guides use vcfppR::vcfcomp function rapidly examine various statistics different scenarios formats, Pearson correlation genotyping (stats=“r2”), Non-Reference Concordance (stats=“nrc”), F1-score (stats=“f1”) Phasing Switch Error (stats=“pse”).","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-1-genotype-imputation-accuracy","dir":"Articles","previous_headings":"","what":"Case 1: Genotype imputation accuracy","title":"Assess the concordance between VCFs","text":"normally get genotype posterior GP genotype dosage DS diploid imputation software, eg QUILT GLIMPSE. examine imputation accuracy, calculate Pearson correlation imputed genotype dosage true genotypes. vcfcomp, need specify desired stats=\"r2\" formats=c(\"DS\",\"GT\"), extract respective FORMAT items testvcf truthvcf. Besides, QUILT2-nipt method outputs MDS FDS maternal fetal genotype dosages constract DS diploid mode. assess imputation accuracy maternal fetal, need specify corresponding formats.","code":"vcfcomp(testvcf, truthvcf, formats = c(\"DS\", \"GT\"), stats = \"r2\") vcfcomp(testvcf, truthvcf, formats = c(\"MDS\", \"GT\"), stats = \"r2\") vcfcomp(testvcf, truthvcf, formats = c(\"FDS\", \"GT\"), stats = \"r2\")"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-2-genotype-concordance","dir":"Articles","previous_headings":"","what":"Case 2: Genotype concordance","title":"Assess the concordance between VCFs","text":"case, interested called genotype concordance sensitivity / specificity genotype calling. addition stats=\"r2\", choose stats=\"f1\" stats=\"nrc\" specify formats=c(\"GT\", \"GT\"). Normally, want results sample, can achieved using .sample=TRUE.","code":"vcfcomp(testvcf, truthvcf, formats = c(\"GT\",\"GT\"), stats=\"nrc\", by.sample=TRUE) vcfcomp(testvcf, truthvcf, formats = c(\"GT\",\"GT\"), stats=\"f1\", by.sample=TRUE)"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-3-phasing-switch-error","dir":"Articles","previous_headings":"","what":"Case 3: Phasing switch error","title":"Assess the concordance between VCFs","text":"case, look functionality assess phasing switch error(PSE). First , need two VCF files contain phased GT, represented ‘|’. can choose return sites PSE. Note: Currently, pse statatics simple form doesn’t take completeness quality account.","code":"vcfcomp(testvcf, truthvcf, stats=\"pse\", return_pse_sites=TRUE)"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-4-multiple-testing-repetitively","dir":"Articles","previous_headings":"","what":"Case 4: Multiple testing repetitively","title":"Assess the concordance between VCFs","text":"comprehensive benchmarking, often run many tests true sets. scenario, can save truth object reuse . Actually, test truth can take input vcftable object RDS file. RDS file stores object returned vcftable. Note: Since input R objects instead VCF path, can use formats option vcfcomp specify new formats ones input R objects.","code":"saveRDS(vcftable(truthvcf), \"truth.rds\") vcfcomp(test=testvcf1, truth=\"truth.rds\") vcfcomp(test=testvcf2, truth=\"truth.rds\") vcfcomp(test=testvcf3, truth=\"truth.rds\")"},{"path":[]},{"path":"/articles/concordance-of-two-vcf-files.html","id":"where-is-the-allele-frequency-from-and-can-i-use-customized-one","dir":"Articles","previous_headings":"Q&A","what":"Where is the allele frequency from and can I use customized one?","title":"Assess the concordance between VCFs","text":"default, allele frequency vairant calculated fly truth VCF based GT. Yes, can specify external file stores allele frequencies database. Currently, vcfcomp can take space-separated text file five columns header named “chr” “pos” “ref” “alt” “af”.","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"how-to-fix-the-error-inconsistent-samples-name","dir":"Articles","previous_headings":"Q&A","what":"How to fix the error “inconsistent samples name”","title":"Assess the concordance between VCFs","text":"one certain samples name testvcf can replaced names can match samples truthvcf. One can use names option specify vector new names can found truthvcf.","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"na-values-returned","dir":"Articles","previous_headings":"Q&A","what":"NA values returned","title":"Assess the concordance between VCFs","text":"make sure read docs carefully use correct FORMAT VCF files set bins bigger intervals NAs variants exist specified intervals bin.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zilong Li. Author, maintainer. Bonfield, James K Marshall, John Danecek, Petr Li, Heng Ohan, Valeriu Whitwham, Andrew Keane, Thomas Davies, Robert M. Copyright holder.           Authors included htslib library","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Li Z (2024). “vcfpp: C++ API rapid processing variant call format.” Bioinformatics, 40(2), btae049. ISSN 1367-4811, doi:10.1093/bioinformatics/btae049.","code":"@Article{,   title = {vcfpp: a C++ API for rapid processing of the variant call format},   author = {Zilong Li},   journal = {Bioinformatics},   volume = {40},   number = {2},   pages = {btae049},   year = {2024},   month = {01},   issn = {1367-4811},   abstract = {Given the widespread use of the variant call format (VCF/BCF) coupled with continuous surge in big data, there remains a perpetual demand for fast and flexible methods to manipulate these comprehensive formats across various programming languages.This work presents vcfpp, a C++ API of HTSlib in a single file, providing an intuitive interface to manipulate VCF/BCF files rapidly and safely, in addition to being portable. Moreover, this work introduces the vcfppR package to demonstrate the development of a high-performance R package with vcfpp, allowing for rapid and straightforward variants analyses.vcfpp is available from https://github.com/Zilong-Li/vcfpp under MIT license. vcfppR is available from https://cran.r-project.org/web/packages/vcfppR.},   doi = {10.1093/bioinformatics/btae049}, }"},{"path":"/index.html","id":"vcfppr-rapid-manipulation-of-the-vcfbcf-file","dir":"","previous_headings":"","what":"Rapid Manipulation of the Variant Call Format (VCF)","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"vcfppR package implements various powerful functions fast genomics analyses VCF/BCF files using C++ API vcfpp.h. Load/save content VCF/BCF R objects highly customizable options Visualize chracterize variants Compare two VCF/BCF files report various statistics Streaming read/write VCF/BCF files fine control everything Paper shows vcfppR fastest","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"","code":"## install.package(\"vcfppR\") ## from CRAN remotes::install_github(\"Zilong-Li/vcfppR\") ## from latest github"},{"path":"/index.html","id":"cite-the-work","dir":"","previous_headings":"","what":"Cite the work","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"find useful, please cite paper","code":"library(vcfppR) citation(\"vcfppR\")"},{"path":"/index.html","id":"url-as-filename","dir":"","previous_headings":"","what":"URL as filename","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"functions vcfppR support URL filename VCF/BCF files.","code":"phasedvcf <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20220422_3202_phased_SNV_INDEL_SV/1kGP_high_coverage_Illumina.chr21.filtered.SNV_INDEL_SV_phased_panel.vcf.gz\" rawvcf <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20201028_3202_raw_GT_with_annot/20201028_CCDG_14151_B01_GRM_WGS_2020-08-05_chr21.recalibrated_variants.vcf.gz\" svfile <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20210124.SV_Illumina_Integration/1KGP_3202.gatksv_svtools_novelins.freeze_V3.wAF.vcf.gz\" popfile <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/20130606_g1k_3202_samples_ped_population.txt\""},{"path":"/index.html","id":"vcftable-read-vcf-as-tabular-data","dir":"","previous_headings":"","what":"vcftable: read VCF as tabular data","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"vcftable gives fine control want extract VCF/BCF files. Read SNP variants GT format two samples Read INDEL variants DP format QUAL>100","code":"library(vcfppR) res <- vcftable(phasedvcf, \"chr21:1-5100000\", samples = \"HG00673,NA10840\", vartype = \"snps\") str(res) #> List of 10 #>  $ samples: chr [1:2] \"HG00673\" \"NA10840\" #>  $ chr    : chr [1:194] \"chr21\" \"chr21\" \"chr21\" \"chr21\" ... #>  $ pos    : int [1:194] 5030578 5030588 5030596 5030673 5030957 5030960 5031004 5031031 5031194 5031224 ... #>  $ id     : chr [1:194] \"21:5030578:C:T\" \"21:5030588:T:C\" \"21:5030596:A:G\" \"21:5030673:G:A\" ... #>  $ ref    : chr [1:194] \"C\" \"T\" \"A\" \"G\" ... #>  $ alt    : chr [1:194] \"T\" \"C\" \"G\" \"A\" ... #>  $ qual   : num [1:194] 2.14e+09 2.14e+09 2.14e+09 2.14e+09 2.14e+09 ... #>  $ filter : chr [1:194] \".\" \".\" \".\" \".\" ... #>  $ info   : chr [1:194] \"AC=74;AF=0.0115553;CM=0;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_unrel=1006;AN\"| __truncated__ \"AC=53;AF=0.00827608;CM=1.78789e-05;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_un\"| __truncated__ \"AC=2;AF=0.000312305;CM=3.21821e-05;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_un\"| __truncated__ \"AC=2;AF=0.000312305;CM=0.00016985;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_unr\"| __truncated__ ... #>  $ gt     : int [1:194, 1:2] 0 0 0 0 0 0 0 0 0 0 ... #>  - attr(*, \"class\")= chr \"vcftable\" res <- vcftable(rawvcf, \"chr21:1-5100000\", vartype = \"indels\", format = \"DP\", qual=100) vcfplot(res, which.sample = 10, ylim=c(0,60), col = 3, pch=19)"},{"path":"/index.html","id":"vcfcomp-compare-two-vcf-files-and-report-concordance","dir":"","previous_headings":"","what":"vcfcomp: compare two VCF files and report concordance","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"Want investigate concordance two VCF files? vcfcomp utility function need! example, benchmarkings, intend calculate genotype correlation test truth.  Check vignettes !","code":"res <- vcfcomp(test = rawvcf, truth = phasedvcf,                stats = \"r2\", region = \"chr21:1-5100000\",                 formats = c(\"GT\",\"GT\"), setid = TRUE) par(mar=c(5,5,2,2), cex.lab = 2) vcfplot(res, col = 2,cex = 2, lwd = 3, type = \"b\")"},{"path":"/index.html","id":"vcfsummary-variants-characterization","dir":"","previous_headings":"","what":"vcfsummary: variants characterization","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"Want summarize variants discovered genotype caller e.g. GATK? vcfsummary utility function need! Small variants  Complex structure variants","code":"res <- vcfsummary(rawvcf,\"chr21:10000000-10010000\") vcfplot(res, pop = popfile, col = 1:5, main = \"Number of SNP & INDEL variants\") res <- vcfsummary(svfile, svtype = TRUE, region = \"chr20\") vcfplot(res, main = \"Structure Variant Counts\", col = 1:7)"},{"path":"/index.html","id":"r-api-of-vcfpph","dir":"","previous_headings":"","what":"R API of vcfpp.h","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"two classes .e. vcfreader vcfwriter offering full R-bindings vcfpp.h. Check examples tests folder refer manual, e.g. ?vcfppR::vcfreader.","code":"library(testthat) svfile <- system.file(\"extdata\", \"sv.vcf.gz\", package=\"vcfppR\") test_that(\"can change samples name and set genotypes for single sample\", {   br <- vcfreader$new(svfile, \"\", \"HG00096\")   br$variant()   expect_identical(br$infoStr(\"SVTYPE\"), \"DUP\")   expect_identical(br$genotypes(F), c(0L, 0L))   br$setGenotypes(c(1L,1L))   expect_identical(br$genotypes(F), c(1L, 1L))   outfile <- paste0(tempfile(), \".vcf.gz\")   br$output(outfile)   br$updateSamples(\"ZZZZZ\")   br$write()   br$close()   vcf <- vcftable(outfile)   expect_true(vcf$gt==2)   expect_true(vcf$samples==\"ZZZZZ\") }) #> Test passed 🎉"},{"path":"/reference/vcfcomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two VCF/BCF files reporting various statistics — vcfcomp","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"Compare two VCF/BCF files reporting various statistics","code":""},{"path":"/reference/vcfcomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"","code":"vcfcomp(   test,   truth,   formats = c(\"DS\", \"GT\"),   stats = \"r2\",   by.sample = FALSE,   by.variant = FALSE,   flip = FALSE,   names = NULL,   bins = NULL,   af = NULL,   out = NULL,   choose_random_start = FALSE,   return_pse_sites = FALSE,   ... )"},{"path":"/reference/vcfcomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"test path comparision file (test), can VCF/BCF file, vcftable object  saved RDS file. truth path baseline file (truth),can VCF/BCF file, vcftable object  saved RDS file. formats character vector. FORMAT tags extract test truth respectively. default c(\"DS\", \"GT\") extracts 'DS' target 'GT' truth. stats statistics calculated. supports following. \"r2\": Pearson correlation coefficient square. \"f1\": F1-score, good balance sensitivity precision. \"nrc\": Non-Reference Concordance rate \"pse\": Phasing Switch Error rate .sample logical. calculate sample-wise concordance, can stratified MAF bin. .variant logical. calculate variant-wise concordance, can stratified MAF bin. .sample .variant FALSE, calculations samples variants together bin. flip logical. flip ref alt variants names character vector. reset samples' names test VCF. bins numeric vector. break statistics allele frequency bins. af file path allele frequency RDS file saved object af. Format text file: space-separated text file five columns header named 'chr' 'pos' 'ref' 'alt' 'af' output prefix saving objects RDS file choose_random_start choose random start stats=\"pse\" return_pse_sites boolean. return phasing switch error sites ... options passed vcftable","code":""},{"path":"/reference/vcfcomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"list various statistics","code":""},{"path":"/reference/vcfcomp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"vcfcomp implements various statisitcs compare two VCF/BCF files, e.g. report genotype concocrdance, correlation stratified allele frequency.","code":""},{"path":"/reference/vcfcomp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfcomp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two VCF/BCF files reporting various statistics — vcfcomp","text":"","code":"library('vcfppR') test <- system.file(\"extdata\", \"imputed.gt.vcf.gz\", package=\"vcfppR\") truth <- system.file(\"extdata\", \"imputed.gt.vcf.gz\", package=\"vcfppR\") samples <- \"HG00133,HG00143,HG00262\" res <- vcfcomp(test, truth, stats=\"f1\", samples=samples, setid=TRUE) str(res)"},{"path":"/reference/vcfinfo.html","id":null,"dir":"Reference","previous_headings":"","what":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"read INFO tag VCF/BCF R data structure","code":""},{"path":"/reference/vcfinfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"","code":"vcfinfo(   vcffile,   tag,   region = \"\",   vartype = \"all\",   ids = NULL,   qual = 0,   pass = FALSE,   setid = FALSE )"},{"path":"/reference/vcfinfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"vcffile path VCF/BCF file tag INFO tag extract. region region subset bcftools-like style: \"chr1\", \"chr1:1-10000000\" vartype restrict specific type variants. supports \"snps\",\"indels\", \"sv\", \"multisnps\",\"multiallelics\" ids character vector. restrict sites ID given vector. default NULL filter sites. qual numeric. restrict variants QUAL > qual. pass logical. restrict variants FILTER = \"PASS\". setid logical. reset ID column CHR_POS_REF_ALT.","code":""},{"path":"/reference/vcfinfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"Return list containing following components: chr : character vector;  CHR column VCF file pos : character vector;  POS column VCF file id : character vector;  ID column VCF file ref : character vector;  REF column VCF file alt : character vector;  ALT column VCF file qual : character vector;  QUAL column VCF file filter : character vector;  FILTER column VCF file tag : vector either integer, numberic character values depending tag extract;  specifiy tag INFO column extracted","code":""},{"path":"/reference/vcfinfo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"vcfinfo uses C++ API vcfpp, wrapper htslib, read VCF/BCF files. Thus, full functionalities htslib, restrict specific variant types, samples regions. memory efficiency reason, vcfinfo designed parse one tag time INFO column VCF. Currently support parsing vector values given INFO tag.","code":""},{"path":"/reference/vcfinfo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfinfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"read a INFO tag in the VCF/BCF into R data structure — vcfinfo","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcfinfo(vcffile, \"AF\", region = \"chr21:1-5050000\", vartype = \"snps\", pass = TRUE) str(res)"},{"path":"/reference/vcfplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Make sensible and beautiful plots based on various objects in vcfppR — vcfplot","title":"Make sensible and beautiful plots based on various objects in vcfppR — vcfplot","text":"Make sensible beautiful plots based various objects vcfppR","code":""},{"path":"/reference/vcfplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make sensible and beautiful plots based on various objects in vcfppR — vcfplot","text":"","code":"vcfplot(obj, which.sample = NULL, variant = c(\"SNP\", \"INDEL\"), pop = NULL, ...)"},{"path":"/reference/vcfplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make sensible and beautiful plots based on various objects in vcfppR — vcfplot","text":"obj object returned vcftable, vcfcomp, vcfsummary .sample sample plotted. NULL aggregate samples. variant types variant desired pop file contains population information ... parameters passed graphics","code":""},{"path":"/reference/vcfpopgen.html","id":null,"dir":"Reference","previous_headings":"","what":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"count heterozygous sites per sample VCF/BCF","code":""},{"path":"/reference/vcfpopgen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"","code":"vcfpopgen(   vcffile,   region = \"\",   samples = \"-\",   pass = FALSE,   qual = 0,   fun = \"heterozygosity\" )"},{"path":"/reference/vcfpopgen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"vcffile path VCF/BCF file region region subset like bcftools samples samples subset like bcftools pass restrict variants FILTER==PASS qual restrict variants QUAL > qual. fun popgen function run. available functions \"heterozygosity\".","code":""},{"path":"/reference/vcfpopgen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"vcfpopgen list containing following components: samples : character vector;  samples ids VCF file subsetting hets : integer vector;  counts heterozygous sites sample order samples","code":""},{"path":"/reference/vcfpopgen.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfpopgen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"count the heterozygous sites per sample in the VCF/BCF — vcfpopgen","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcfpopgen(vcffile) str(res)"},{"path":"/reference/vcfppR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) — vcfppR-package","title":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) — vcfppR-package","text":"'vcfpp.h' (https://github.com/Zilong-Li/vcfpp) provides easy--use 'C++' 'API' 'htslib', offering full functionality manipulating Variant Call Format (VCF) files. 'vcfppR' package serves R bindings 'vcfpp.h' library, enabling rapid processing compressed uncompressed VCF files. Explore range powerful features efficient VCF data manipulation.","code":""},{"path":[]},{"path":"/reference/vcfppR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) — vcfppR-package","text":"Maintainer: Zilong Li zilong.dk@gmail.com (ORCID) contributors: Bonfield, James K Marshall, John Danecek, Petr Li, Heng Ohan, Valeriu Whitwham, Andrew Keane, Thomas Davies, Robert M (Authors included htslib library) [copyright holder]","code":""},{"path":"/reference/vcfreader.html","id":null,"dir":"Reference","previous_headings":"","what":"API for manipulating the VCF/BCF. — vcfreader","title":"API for manipulating the VCF/BCF. — vcfreader","text":"Type name class see details methods","code":""},{"path":"/reference/vcfreader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"API for manipulating the VCF/BCF. — vcfreader","text":"C++ class following fields/methods manipulating VCF/BCF","code":""},{"path":"/reference/vcfreader.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"API for manipulating the VCF/BCF. — vcfreader","text":"new Constructor given vcf file Parameter: vcffile - path vcf file new Constructor given vcf file region Parameter: vcffile - path vcf file Parameter: region - region constrained new Constructor given vcf file, region samples Parameter: vcffile - path vcf file Parameter: region - region constrained Parameter: samples - samples constrained. Comma separated list samples include (exclude \"^\" prefix). setRegion try set specific region work . throw errors index region found. Use getStatus check region valid empty! getStatus return 1: region valid empty. 0: region valid empty. -1: index file. -2: region found invalid region form variant Try get next variant record. return FALSE variants hit end file, otherwise TRUE. chr Return CHROM field current variant pos Return POS field current variant id Return CHROM field current variant ref Return REF field current variant alt Return ALT field current variant qual Return QUAL field current variant filter Return FILTER field current variant info Return INFO field current variant infoInt Return tag value integer type INFO field current variant Parameter: tag - tag name retrieve INFO infoFloat Return tag value float type INFO field current variant Parameter: tag - tag name retrieve INFO infoStr Return tag value string type INFO field current variant Parameter: tag - tag name retrieve INFO infoIntVec Return tag value vector integer type INFO field current variant Parameter: tag - tag name retrieve INFO infoFloatVec Return tag value vector float type INFO field current variant Parameter: tag - tag name retrieve INFO genotypes Return genotype values vector integers Parameter: collapse - Boolean value indicates wheather collapse size genotypes, eg, return diploid genotypes. formatInt Return tag value integer type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT formatFloat Return tag value float type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT formatStr Return tag value string type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT isSNP Test current variant exculsively SNP isIndel Test current variant exculsively INDEL isSV Test current variant exculsively SV isMultiAllelics Test current variant exculsively Multi Allelics isMultiAllelicSNP Test current variant exculsively Multi Biallelics (SNPs) hasSNP Test current variant SNP hasINDEL Test current variant INDEL hasINS Test current variant INS hasDEL Test current variant DEL hasMNP Test current variant MNP hasBND Test current variant BND hasOTHER Test current variant hasOVERLAP Test current variant OVERLAP nsamples Return number samples samples Return vector samples id header Return raw string vcf header string Return raw string current variant including newline line Return raw string current variant without newline output Init output object streaming variants another vcf updateSamples update samples name output VCF Parameter: s - comma-seperated string new samples names write Streaming current variant output vcf close Close connection output vcf setCHR Modify CHR current variant Parameter: s - string CHR setID Modify ID current variant Parameter: s - string ID setPOS Modify POS current variant Parameter: pos - integer POS setRefAlt Modify REF ALT current variant Parameter: s - string reperated comma setInfoInt Modify given tag INT type INFO current variant Parameter: tag - string tag name Parameter: v - integer tag value setInfoFloat Modify given tag FLOAT type INFO current variant Parameter: tag - string tag name Parameter: v - double tag value setInfoStr Modify given tag STRING type INFO current variant Parameter: tag - string tag name Parameter: s - string tag value setPhasing Modify phasing status sample Parameter: v - integer vector size number samples. 1s 0s valid. setGenotypes Modify genotypes current variant Parameter: v - integer vector genotypes. Use NA -9 missing value. setFormatInt Modify given tag INT type FORMAT current variant Parameter: tag - string tag name Parameter: v - integer tag value setFormatFloat Modify given tag FLOAT type FORMAT current variant Parameter: tag - string tag name Parameter: v - double tag value setFormatStr Modify given tag STRING type FORMAT current variant Parameter: tag - string tag name Parameter: s - string tag value rmInfoTag Remove given tag INFO current variant Parameter: s - string tag name rmFormatTag Remove given tag FORMAT current variant Parameter: s - string tag name setVariant Modify current variant adding vcf line Parameter: s - string one line VCF addINFO Add INFO header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addFORMAT Add FORMAT header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means","code":""},{"path":"/reference/vcfreader.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"API for manipulating the VCF/BCF. — vcfreader","text":"","code":"vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") br <- vcfreader$new(vcffile) res <- rep(0L, br$nsamples()) while(br$variant()) {   if(br$isSNP()) {   gt <- br$genotypes(TRUE) == 1   gt[is.na(gt)] <- FALSE   res <- res + gt   } }"},{"path":"/reference/vcfsummary.html","id":null,"dir":"Reference","previous_headings":"","what":"summarize the various variant types at both variant level and sample level. — vcfsummary","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"summarize various variant types variant level sample level.","code":""},{"path":"/reference/vcfsummary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"","code":"vcfsummary(   vcffile,   region = \"\",   samples = \"-\",   pass = FALSE,   qual = 0,   svtype = FALSE )"},{"path":"/reference/vcfsummary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"vcffile path VCF/BCF file region region subset like bcftools samples samples subset like bcftools pass restrict variants FILTER==PASS qual restrict variants QUAL > qual. svtype summarize variants SVTYPE","code":""},{"path":"/reference/vcfsummary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"vcfsummary list containing following components: summary : named integer vector;  summarize counts variant type samples : character vector;  samples ids VCF file subsetting vartype : integer vector;  counts variant type sample level order samples","code":""},{"path":"/reference/vcfsummary.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"bcftools view -s \"id01,id02\" input.bcf.gz chr1:100000-20000","code":""},{"path":"/reference/vcfsummary.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfsummary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summarize the various variant types at both variant level and sample level. — vcfsummary","text":"","code":"library('vcfppR') svfile <- system.file(\"extdata\", \"sv.vcf.gz\", package=\"vcfppR\") res <- vcfsummary(svfile, region = \"chr21:1-10000000\", svtype = TRUE) str(res)"},{"path":"/reference/vcftable.html","id":null,"dir":"Reference","previous_headings":"","what":"read VCF/BCF contents into R data structure — vcftable","title":"read VCF/BCF contents into R data structure — vcftable","text":"swiss army knife reading VCF/BCF R data types rapidly easily.","code":""},{"path":"/reference/vcftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read VCF/BCF contents into R data structure — vcftable","text":"","code":"vcftable(   vcffile,   region = \"\",   samples = \"-\",   vartype = \"all\",   format = \"GT\",   ids = NULL,   qual = 0,   pass = FALSE,   info = TRUE,   collapse = TRUE,   setid = FALSE,   mac = 0,   rmdup = FALSE )"},{"path":"/reference/vcftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read VCF/BCF contents into R data structure — vcftable","text":"vcffile path VCF/BCF file region region subset bcftools-like style: \"chr1\", \"chr1:1-10000000\" samples samples subset bcftools-like style. comma separated list samples include (exclude \"^\" prefix). e.g. \"id01,id02\", \"^id01,id02\". vartype restrict specific type variants. supports \"snps\",\"indels\", \"sv\", \"multisnps\",\"multiallelics\" format FORMAT tag extract. default \"GT\" extracted. ids character vector. restrict sites ID given vector. default NULL filter sites. qual numeric. restrict variants QUAL > qual. pass logical. restrict variants FILTER = \"PASS\". info logical. drop INFO column returned list. collapse logical. acts FORMAT. FORMAT extract \"GT\", dim raw genotypes matrix diploid (M, 2 * N), M #markers N #samples. default TRUE collapse genotypes sample matrix (M, N). Set FALSE one wants maintain phasing order, e.g. \"1|0\" parsed c(1, 0) collapse=FALSE. FORMAT extract \"GT\", collapse=TRUE try turn list extracted vector matrix. However, raises issues one variant mutliallelic resulting vaules others. setid logical. reset ID column CHR_POS_REF_ALT. mac integer. restrict variants minor allele count higher value. rmdup logical. remove duplicated sites keeping first occurrence POS. (default: FALSE)","code":""},{"path":"/reference/vcftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"read VCF/BCF contents into R data structure — vcftable","text":"Return list containing following components: samples : character vector;  samples ids VCF file subsetting chr : character vector;  CHR column VCF file pos : character vector;  POS column VCF file id : character vector;  ID column VCF file ref : character vector;  REF column VCF file alt : character vector;  ALT column VCF file qual : character vector;  QUAL column VCF file filter : character vector;  FILTER column VCF file info : character vector;  INFO column VCF file format : matrix either integer numberic values depending tag extract;  specifiy tag FORMAT column extracted","code":""},{"path":"/reference/vcftable.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"read VCF/BCF contents into R data structure — vcftable","text":"vcftable uses C++ API vcfpp, wrapper htslib, read VCF/BCF files. Thus, full functionalities htslib, restrict specific variant types, samples regions. memory efficiency reason, vcftable designed parse one tag time FORMAT column VCF. default, matrix genotypes, .e. \"GT\" tag, returned vcftable, many tags supported format option.","code":""},{"path":"/reference/vcftable.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"read VCF/BCF contents into R data structure — vcftable","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"read VCF/BCF contents into R data structure — vcftable","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcftable(vcffile, \"chr21:1-5050000\", vartype = \"snps\") str(res)"},{"path":"/reference/vcfwriter.html","id":null,"dir":"Reference","previous_headings":"","what":"API for writing the VCF/BCF. — vcfwriter","title":"API for writing the VCF/BCF. — vcfwriter","text":"Type name class see details methods","code":""},{"path":"/reference/vcfwriter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"API for writing the VCF/BCF. — vcfwriter","text":"C++ class following fields/methods writing VCF/BCF","code":""},{"path":"/reference/vcfwriter.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"API for writing the VCF/BCF. — vcfwriter","text":"new Constructor given vcf file Parameter: vcffile - path vcf file. start \"~\" Parameter: version - version VCF specification addContig Add Contig header vcf Parameter: str - string CONTIG name addFILTER Add FILTER header vcf Parameter: id - string FILTER name Parameter: desc - string description means addINFO Add INFO header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addFORMAT Add FORMAT header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addSample Add SAMPLE header vcf Parameter: str - string SAMPLE name addLine Add line header vcf Parameter: str - string line header VCF writeline Write variant record given line Parameter: line - string line variant VCF. ended \"newline\" close Close save vcf file","code":""},{"path":"/reference/vcfwriter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"API for writing the VCF/BCF. — vcfwriter","text":"","code":"outvcf <- file.path(paste0(tempfile(), \".vcf.gz\")) bw <- vcfwriter$new(outvcf, \"VCF4.1\") bw$addContig(\"chr20\") bw$addFORMAT(\"GT\", \"1\", \"String\", \"Genotype\"); bw$addSample(\"NA12878\") s1 <- \"chr20\\t2006060\\t.\\tG\\tC\\t100\\tPASS\\t.\\tGT\\t1|0\" bw$writeline(s1) bw$close()"},{"path":"/news/index.html","id":"vcfppr-080","dir":"Changelog","previous_headings":"","what":"vcfppR 0.8.0","title":"vcfppR 0.8.0","text":"copy static libs libs folder","code":""},{"path":"/news/index.html","id":"vcfppr-076","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.6","title":"vcfppR 0.7.6","text":"CRAN release: 2025-03-31 fix CRAN notes","code":""},{"path":"/news/index.html","id":"vcfppr-075","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.5","title":"vcfppR 0.7.5","text":"fix issue #14 handle libdeflate dependency linux","code":""},{"path":"/news/index.html","id":"vcfppr-074","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.4","title":"vcfppR 0.7.4","text":"fix issue #13 speedup setRegion","code":""},{"path":"/news/index.html","id":"vcfppr-073","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.3","title":"vcfppR 0.7.3","text":"enable libdeflate linux","code":""},{"path":"/news/index.html","id":"vcfppr-072","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.2","title":"vcfppR 0.7.2","text":"make htslib available including linking packages","code":""},{"path":"/news/index.html","id":"vcfppr-070","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.0","title":"vcfppR 0.7.0","text":"CRAN release: 2024-12-21 fix parsing BCF subsetting sample ids genomic region time fix vcfcomp stats=\"nrc\" input vectors different length use latest version htslib v1.21 reduce size installation","code":""},{"path":"/news/index.html","id":"vcfppr-060","dir":"Changelog","previous_headings":"","what":"vcfppR 0.6.0","title":"vcfppR 0.6.0","text":"CRAN release: 2024-09-29 upgrade vcfpp.h v0.6.0 new API vcfreader$setRegion new API vcfreader$getStatus","code":""},{"path":"/news/index.html","id":"vcfppr-050","dir":"Changelog","previous_headings":"","what":"vcfppR 0.5.0","title":"vcfppR 0.5.0","text":"CRAN release: 2024-09-22 upgrade vcfpp.h v0.5.1 add bcfreader$updateSamples() function vcfcomp: can take vcftable object input vcfcomp: defaults changed setid=FALSE bug fix","code":""},{"path":"/news/index.html","id":"vcfppr-046","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.6","title":"vcfppR 0.4.6","text":"CRAN release: 2024-05-24 add vcfplot function fix bug vcftable FORMAT unaligned list add vignette vcfcomp","code":""},{"path":"/news/index.html","id":"vcfppr-045","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.5","title":"vcfppR 0.4.5","text":"CRAN release: 2024-04-08 add vcfcomp function fix memory leaks pass ASAN check","code":""},{"path":"/news/index.html","id":"vcfppr-040","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.0","title":"vcfppR 0.4.0","text":"CRAN release: 2024-02-26 add setid option vcftable patches upcoming Rtools windows","code":""},{"path":"/news/index.html","id":"vcfppr-038","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.8","title":"vcfppR 0.3.8","text":"CRAN release: 2024-01-14 fix issues M1 Mac","code":""},{"path":"/news/index.html","id":"vcfppr-037","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.7","title":"vcfppR 0.3.7","text":"add vcfreader@rmFormatTag() add vcfreader@samples() vcftable supports vartype = ‘sv’","code":""},{"path":"/news/index.html","id":"vcfppr-036","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.6","title":"vcfppR 0.3.6","text":"add vcfreader::line remove vcfreader::setVariant bug fix setFormatStr units tests","code":""},{"path":"/news/index.html","id":"vcfppr-035","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.5","title":"vcfppR 0.3.5","text":"CRAN release: 2023-12-14 add vcfreader vcfwriter","code":""},{"path":"/news/index.html","id":"vcfppr-034","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.4","title":"vcfppR 0.3.4","text":"support filters variant ID","code":""},{"path":"/news/index.html","id":"vcfppr-033","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.3","title":"vcfppR 0.3.3","text":"use API vcfpp.h v0.3.1 set missing vaules FORMAT NA support filters QUAL, FILTER INFO","code":""},{"path":"/news/index.html","id":"vcfppr-030","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.0","title":"vcfppR 0.3.0","text":"First release using vcfpp.h v0.3.0 add vcftable function add vcfsummary function add vcfpopgen function","code":""}]
