[{"path":"/CLAUDE.html","id":null,"dir":"","previous_headings":"","what":"CLAUDE.md","title":"CLAUDE.md","text":"file provides guidance Claude Code (claude.ai/code) working code repository.","code":""},{"path":"/CLAUDE.html","id":"project-overview","dir":"","previous_headings":"","what":"Project Overview","title":"CLAUDE.md","text":"vcfppR R package providing rapid manipulation VCF/BCF (Variant Call Format) files. implements R bindings C++ library vcfpp.h, wraps htslib high-performance genomics analyses. package published CRAN optimized speed processing compressed uncompressed VCF files.","code":""},{"path":[]},{"path":"/CLAUDE.html","id":"core-components","dir":"","previous_headings":"Architecture","what":"Core Components","title":"CLAUDE.md","text":"R API Layer (R/ directory): - vcf-tables.R - Main entry point reading VCF/BCF R data structures via vcftable() - vcf-compare.R - Compare two VCF files vcfcomp() (calculates r2, F1, NRC, PSE statistics) - vcf-summary.R - Summarize variant types variant/sample level via vcfsummary() - vcf-plot.R - Visualization utilities VCF data vcfplot() - vcf-popgen.R - Population genetics analyses - vcf-info.R - INFO field extraction utilities - RcppExports.R - Auto-generated Rcpp bindings C++ Implementation Layer (src/ directory): - vcf-reader.cpp - Exposes vcfreader R6 class streaming VCF reading - vcf-writer.cpp - Exposes vcfwriter R6 class streaming VCF writing - vcf-table.cpp - C++ implementation vcftable functionality - vcf-stats.cpp - Statistics calculations (concordance, correlation, etc.) - vcf-popgen.cpp - Population genetics computations vcfpp.h Interface (inst/include/vcfpp.h): - Single-header C++ library wrapping htslib - Provides BcfReader, BcfWriter, BcfRecord, BcfHeader classes - core abstraction htslib‚Äôs C API Bundled htslib (src/htslib-1.21/): - Complete htslib 1.21 source code bundled package - Compiled package installation","code":""},{"path":"/CLAUDE.html","id":"key-design-patterns","dir":"","previous_headings":"Architecture","what":"Key Design Patterns","title":"CLAUDE.md","text":"Two-Level API: High-level R functions (vcftable, vcfcomp, vcfsummary) common tasks, plus low-level R6 classes (vcfreader, vcfwriter) fine-grained control Streaming Architecture: reader writer classes support streaming operations memory-efficient processing large VCF files Format Flexibility: functions accept file paths URLs input Rcpp Integration: C++ code exposed R via Rcpp modules exported functions","code":""},{"path":[]},{"path":"/CLAUDE.html","id":"building-and-installation","dir":"","previous_headings":"Development Commands","what":"Building and Installation","title":"CLAUDE.md","text":"","code":"make rd              # Generate documentation with roxygen2 make build           # Build source package make install         # Build and install package locally"},{"path":"/CLAUDE.html","id":"testing","dir":"","previous_headings":"Development Commands","what":"Testing","title":"CLAUDE.md","text":"","code":"# Run all tests Rscript -e 'devtools::test()'  # Run specific test file Rscript -e 'testthat::test_file(\"tests/testthat/test-vcf-table.R\")'  # Run tests interactively in R R > library(testthat) > library(vcfppR) > test_check(\"vcfppR\")"},{"path":"/CLAUDE.html","id":"quality-checks","dir":"","previous_headings":"Development Commands","what":"Quality Checks","title":"CLAUDE.md","text":"","code":"make check           # Run devtools::check() make check2          # Run R CMD check --as-cran (stricter)"},{"path":"/CLAUDE.html","id":"documentation","dir":"","previous_headings":"Development Commands","what":"Documentation","title":"CLAUDE.md","text":"","code":"make readme          # Render README.Rmd and build pkgdown site make readme2         # Render README.Rmd to HTML only"},{"path":"/CLAUDE.html","id":"cleanup","dir":"","previous_headings":"Development Commands","what":"Cleanup","title":"CLAUDE.md","text":"","code":"make clean           # Remove build artifacts ./cleanup            # Platform-specific cleanup script"},{"path":[]},{"path":"/CLAUDE.html","id":"compilation-requirements","dir":"","previous_headings":"Working with C++ Code","what":"Compilation Requirements","title":"CLAUDE.md","text":"System dependencies: libcurl-devel (rpm) libcurl4-openssl-dev (deb), GNU make Configure scripts: configure (Unix/Linux), configure.win (Windows) Cleanup scripts: cleanup (Unix/Linux), cleanup.win (Windows)","code":""},{"path":"/CLAUDE.html","id":"modifying-vcfpph","dir":"","previous_headings":"Working with C++ Code","what":"Modifying vcfpp.h","title":"CLAUDE.md","text":"vcfpp.h header located inst/include/vcfpp.h. header-library wraps htslib. changes affect core VCF manipulation capabilities.","code":""},{"path":"/CLAUDE.html","id":"adding-new-c-functions","dir":"","previous_headings":"Working with C++ Code","what":"Adding New C++ Functions","title":"CLAUDE.md","text":"Add implementation appropriate src/*.cpp file exposing R, use Rcpp attributes (// [[Rcpp::export]]) Run make rd regenerate RcppExports Add R wrapper function corresponding R/*.R file Document roxygen2 comments","code":""},{"path":"/CLAUDE.html","id":"r6-classes-vcfreadervcfwriter","dir":"","previous_headings":"Working with C++ Code","what":"R6 Classes (vcfreader/vcfwriter)","title":"CLAUDE.md","text":"classes provide full vcfpp.h API R users. See src/vcf-reader.cpp src/vcf-writer.cpp implementation. Documentation generated C++ comments special roxygen format.","code":""},{"path":"/CLAUDE.html","id":"testing-guidelines","dir":"","previous_headings":"","what":"Testing Guidelines","title":"CLAUDE.md","text":"Tests tests/testthat/ using testthat framework (edition 3). Key test files: - test-vcf-table.R - Tests vcftable() function - test-vcf-reader.R - Tests vcfreader class - test-vcf-writer.R - Tests vcfwriter class - test-vcf-comp.R - Tests vcfcomp() comparisons - test-vcf-summary.R - Tests vcfsummary() - test-vcf-integration.R, test-vcf-intersect.R - Integration tests Test data inst/extdata/. Tests use local files remote URLs 1000 Genomes Project.","code":""},{"path":[]},{"path":"/CLAUDE.html","id":"format-tags-and-parsing","dir":"","previous_headings":"Important Implementation Details","what":"Format Tags and Parsing","title":"CLAUDE.md","text":"vcftable() parses one FORMAT tag time memory efficiency Default FORMAT ‚ÄúGT‚Äù (genotypes) collapse parameter controls genotypes returned: TRUE collapses phased genotypes single values, FALSE preserves phasing order multiallelic variants, collapse=TRUE may cause issues non-GT formats","code":""},{"path":"/CLAUDE.html","id":"statistics-in-vcfcomp","dir":"","previous_headings":"Important Implementation Details","what":"Statistics in vcfcomp","title":"CLAUDE.md","text":"‚Äúr2‚Äù, ‚Äúf1‚Äù, ‚Äúnrc‚Äù, ‚Äúpse‚Äù require GT format ‚Äúgtgq‚Äù ‚Äúgtdp‚Äù perform quality/depth-based concordance analysis Allele frequency binning automatic unless custom bins provided PSE (Phasing Switch Error) calculation can use random deterministic start","code":""},{"path":"/CLAUDE.html","id":"variant-type-filtering","dir":"","previous_headings":"Important Implementation Details","what":"Variant Type Filtering","title":"CLAUDE.md","text":"vcftable vcfsummary support vartype parameter: - ‚Äúsnps‚Äù - SNP variants - ‚Äúindels‚Äù - INDEL variants - ‚Äúsv‚Äù - Structural variants - ‚Äúmultisnps‚Äù - Multi-allelic SNPs - ‚Äúmultiallelics‚Äù - Multi-allelic variants","code":""},{"path":"/CLAUDE.html","id":"url-support","dir":"","previous_headings":"Important Implementation Details","what":"URL Support","title":"CLAUDE.md","text":"functions support URLs filenames (automatically upgraded HTTPS). enables direct analysis remote VCF files without downloading.","code":""},{"path":"/CLAUDE.html","id":"package-metadata","dir":"","previous_headings":"","what":"Package Metadata","title":"CLAUDE.md","text":"CRAN package name: vcfppR License: MIT System requirements: libcurl, GNU make Dependencies: Rcpp, methods, stats, utils Suggests: knitr, rmarkdown, testthat Paper: https://doi.org/10.1093/bioinformatics/btae049","code":""},{"path":"/CONTRIBUTING.html","id":"contributing-to-vcfppr","dir":"","previous_headings":"","what":"Contributing to vcfppR","title":"NA","text":"Please see file Contributing details report issue: Minimally Complete () Verifiable Example (MCVE) helps lot; submit pull request: post issue first, get consensus ; follow (informal) coding style: simply files invent new style; nice NEWS.Rd","code":""},{"path":"/PULL_REQUEST_TEMPLATE.html","id":"pull-request-template-for-rcpp","dir":"","previous_headings":"","what":"Pull Request Template for Rcpp","title":"NA","text":"Please explain changes want apply Rcpp, preferably issue ticket create pull request. See file Contributing templates details.","code":""},{"path":"/PULL_REQUEST_TEMPLATE.html","id":"checklist","dir":"","previous_headings":"Pull Request Template for Rcpp","what":"Checklist","title":"NA","text":"Code compiles correctly R CMD check still passes tests Preferably, new tests added fail without change Document changes file ChangeLog","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Assess the concordance between VCFs","text":"benchmarking, ‚Äôs often need calculate concordance rate test set truth set. truth VCF file, always true genotypes GT otherwise can‚Äôt validate test VCF. test VCF may variant caller genotype imputation program, format can variable, e.g GP, DS GT. Hence, article guides use vcfppR::vcfcomp function rapidly examine various statistics different scenarios formats, Pearson correlation genotyping (stats=‚Äúr2‚Äù), Non-Reference Concordance (stats=‚Äúnrc‚Äù), F1-score (stats=‚Äúf1‚Äù) Phasing Switch Error (stats=‚Äúpse‚Äù).","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-1-genotype-imputation-accuracy","dir":"Articles","previous_headings":"","what":"Case 1: Genotype imputation accuracy","title":"Assess the concordance between VCFs","text":"normally get genotype posterior GP genotype dosage DS diploid imputation software, eg QUILT GLIMPSE. examine imputation accuracy, calculate Pearson correlation imputed genotype dosage true genotypes. vcfcomp, need specify desired stats=\"r2\" formats=c(\"DS\",\"GT\"), extract respective FORMAT items testvcf truthvcf. Besides, QUILT2-nipt method outputs MDS FDS maternal fetal genotype dosages constract DS diploid mode. assess imputation accuracy maternal fetal, need specify corresponding formats.","code":"vcfcomp(testvcf, truthvcf, formats = c(\"DS\", \"GT\"), stats = \"r2\") vcfcomp(testvcf, truthvcf, formats = c(\"MDS\", \"GT\"), stats = \"r2\") vcfcomp(testvcf, truthvcf, formats = c(\"FDS\", \"GT\"), stats = \"r2\")"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-2-genotype-concordance","dir":"Articles","previous_headings":"","what":"Case 2: Genotype concordance","title":"Assess the concordance between VCFs","text":"case, interested called genotype concordance sensitivity / specificity genotype calling. addition stats=\"r2\", choose stats=\"f1\" stats=\"nrc\" specify formats=c(\"GT\", \"GT\"). Normally, want results sample, can achieved using .sample=TRUE.","code":"vcfcomp(testvcf, truthvcf, formats = c(\"GT\",\"GT\"), stats=\"nrc\", by.sample=TRUE) vcfcomp(testvcf, truthvcf, formats = c(\"GT\",\"GT\"), stats=\"f1\", by.sample=TRUE)"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-3-phasing-switch-error","dir":"Articles","previous_headings":"","what":"Case 3: Phasing switch error","title":"Assess the concordance between VCFs","text":"case, look functionality assess phasing switch error(PSE). First , need two VCF files contain phased GT, represented ‚Äò|‚Äô. can choose return sites PSE. Note: Currently, pse statatics simple form doesn‚Äôt take completeness quality account.","code":"vcfcomp(testvcf, truthvcf, stats=\"pse\", return_pse_sites=TRUE)"},{"path":"/articles/concordance-of-two-vcf-files.html","id":"case-4-multiple-testing-repetitively","dir":"Articles","previous_headings":"","what":"Case 4: Multiple testing repetitively","title":"Assess the concordance between VCFs","text":"comprehensive benchmarking, often run many tests true sets. scenario, can save truth object reuse . Actually, test truth can take input vcftable object RDS file. RDS file stores object returned vcftable. Note: Since input R objects instead VCF path, can use formats option vcfcomp specify new formats ones input R objects.","code":"saveRDS(vcftable(truthvcf), \"truth.rds\") vcfcomp(test=testvcf1, truth=\"truth.rds\") vcfcomp(test=testvcf2, truth=\"truth.rds\") vcfcomp(test=testvcf3, truth=\"truth.rds\")"},{"path":[]},{"path":"/articles/concordance-of-two-vcf-files.html","id":"where-is-the-allele-frequency-from-and-can-i-use-customized-one","dir":"Articles","previous_headings":"Q&A","what":"Where is the allele frequency from and can I use customized one?","title":"Assess the concordance between VCFs","text":"default, allele frequency vairant calculated fly truth VCF based GT. Yes, can specify external file stores allele frequencies database. Currently, vcfcomp can take space-separated text file five columns header named ‚Äúchr‚Äù ‚Äúpos‚Äù ‚Äúref‚Äù ‚Äúalt‚Äù ‚Äúaf‚Äù.","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"how-to-fix-the-error-inconsistent-samples-name","dir":"Articles","previous_headings":"Q&A","what":"How to fix the error ‚Äúinconsistent samples name‚Äù","title":"Assess the concordance between VCFs","text":"one certain samples name testvcf can replaced names can match samples truthvcf. One can use names option specify vector new names can found truthvcf.","code":""},{"path":"/articles/concordance-of-two-vcf-files.html","id":"na-values-returned","dir":"Articles","previous_headings":"Q&A","what":"NA values returned","title":"Assess the concordance between VCFs","text":"make sure read docs carefully use correct FORMAT VCF files set bins bigger intervals NAs variants exist specified intervals bin.","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zilong Li. Author, maintainer. Bonfield, James K Marshall, John Danecek, Petr Li, Heng Ohan, Valeriu Whitwham, Andrew Keane, Thomas Davies, Robert M. Copyright holder.           Authors included htslib library","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Li Z (2024). ‚Äúvcfpp: C++ API rapid processing variant call format.‚Äù Bioinformatics, 40(2), btae049. ISSN 1367-4811, doi:10.1093/bioinformatics/btae049.","code":"@Article{,   title = {vcfpp: a C++ API for rapid processing of the variant call format},   author = {Zilong Li},   journal = {Bioinformatics},   volume = {40},   number = {2},   pages = {btae049},   year = {2024},   month = {01},   issn = {1367-4811},   abstract = {Given the widespread use of the variant call format (VCF/BCF) coupled with continuous surge in big data, there remains a perpetual demand for fast and flexible methods to manipulate these comprehensive formats across various programming languages.This work presents vcfpp, a C++ API of HTSlib in a single file, providing an intuitive interface to manipulate VCF/BCF files rapidly and safely, in addition to being portable. Moreover, this work introduces the vcfppR package to demonstrate the development of a high-performance R package with vcfpp, allowing for rapid and straightforward variants analyses.vcfpp is available from https://github.com/Zilong-Li/vcfpp under MIT license. vcfppR is available from https://cran.r-project.org/web/packages/vcfppR.},   doi = {10.1093/bioinformatics/btae049}, }"},{"path":"/index.html","id":"vcfppr-rapid-manipulation-of-the-vcfbcf-file","dir":"","previous_headings":"","what":"Rapid Manipulation of the Variant Call Format (VCF)","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"vcfppR package implements various powerful functions fast genomics analyses VCF/BCF files using C++ API vcfpp.h. Load/save content VCF/BCF R objects highly customizable options Visualize chracterize variants Compare two VCF/BCF files report various statistics Streaming read/write VCF/BCF files fine control everything Paper shows vcfppR fastest","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"","code":"## install.package(\"vcfppR\") ## from CRAN remotes::install_github(\"Zilong-Li/vcfppR\") ## from latest github"},{"path":"/index.html","id":"cite-the-work","dir":"","previous_headings":"","what":"Cite the work","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"find useful, please cite paper","code":"library(vcfppR) citation(\"vcfppR\")"},{"path":"/index.html","id":"url-as-filename","dir":"","previous_headings":"","what":"URL as filename","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"functions vcfppR support URL filename VCF/BCF files.","code":"phasedvcf <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20220422_3202_phased_SNV_INDEL_SV/1kGP_high_coverage_Illumina.chr21.filtered.SNV_INDEL_SV_phased_panel.vcf.gz\" rawvcf <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20201028_3202_raw_GT_with_annot/20201028_CCDG_14151_B01_GRM_WGS_2020-08-05_chr21.recalibrated_variants.vcf.gz\" svfile <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20210124.SV_Illumina_Integration/1KGP_3202.gatksv_svtools_novelins.freeze_V3.wAF.vcf.gz\" popfile <- \"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/20130606_g1k_3202_samples_ped_population.txt\""},{"path":"/index.html","id":"vcftable-read-vcf-as-tabular-data","dir":"","previous_headings":"","what":"vcftable: read VCF as tabular data","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"vcftable gives fine control want extract VCF/BCF files. Read SNP variants GT format two samples Read variants followed subsetting operations Read INDEL variants DP format QUAL>100","code":"library(vcfppR) res <- vcftable(phasedvcf, \"chr21:1-5100000\", samples = \"HG00673,NA10840\", vartype = \"snps\") str(res) #> List of 10 #>  $ samples: chr [1:2] \"HG00673\" \"NA10840\" #>  $ chr    : chr [1:194] \"chr21\" \"chr21\" \"chr21\" \"chr21\" ... #>  $ pos    : int [1:194] 5030578 5030588 5030596 5030673 5030957 5030960 5031004 5031031 5031194 5031224 ... #>  $ id     : chr [1:194] \"21:5030578:C:T\" \"21:5030588:T:C\" \"21:5030596:A:G\" \"21:5030673:G:A\" ... #>  $ ref    : chr [1:194] \"C\" \"T\" \"A\" \"G\" ... #>  $ alt    : chr [1:194] \"T\" \"C\" \"G\" \"A\" ... #>  $ qual   : num [1:194] 2.14e+09 2.14e+09 2.14e+09 2.14e+09 2.14e+09 ... #>  $ filter : chr [1:194] \".\" \".\" \".\" \".\" ... #>  $ info   : chr [1:194] \"AC=74;AF=0.0115553;CM=0;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_unrel=1006;AN\"| __truncated__ \"AC=53;AF=0.00827608;CM=1.78789e-05;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_un\"| __truncated__ \"AC=2;AF=0.000312305;CM=3.21821e-05;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_un\"| __truncated__ \"AC=2;AF=0.000312305;CM=0.00016985;AN=6404;AN_EAS=1170;AN_AMR=980;AN_EUR=1266;AN_AFR=1786;AN_SAS=1202;AN_EUR_unr\"| __truncated__ ... #>  $ gt     : int [1:194, 1:2] 0 0 0 0 0 0 0 0 0 0 ... #>  - attr(*, \"class\")= chr \"vcftable\" vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcftable(vcffile, \"chr21:1-5050000\") str(subset(res, pos >= 5000000 & pos <= 5030300 & nchar(ref) == 1 & nchar(alt) == 1)) #> List of 10 #>  $ samples: chr [1:3202] \"HG00096\" \"HG00097\" \"HG00099\" \"HG00100\" ... #>  $ chr    : chr [1:5] \"chr21\" \"chr21\" \"chr21\" \"chr21\" ... #>  $ pos    : int [1:5] 5030082 5030088 5030105 5030253 5030278 #>  $ id     : chr [1:5] \"chr21:5030082:G:A\" \"chr21:5030088:C:T\" \"chr21:5030105:C:A\" \"chr21:5030253:G:T\" ... #>  $ ref    : chr [1:5] \"G\" \"C\" \"C\" \"G\" ... #>  $ alt    : chr [1:5] \"A\" \"T\" \"A\" \"T\" ... #>  $ qual   : num [1:5] 70.1 2773.1 3897.8 102.6 868.9 #>  $ filter : chr [1:5] \"VQSRTrancheSNP99.80to100.00\" \"VQSRTrancheSNP99.80to100.00\" \"VQSRTrancheSNP99.80to100.00\" \"VQSRTrancheSNP99.80to100.00\" ... #>  $ info   : chr [1:5] \"AC=2;AF=0.000616523;AN=3244;DP=2498;FS=0;MLEAC=1;MLEAF=0.0003083;MQ=17.07;MQ0=0;QD=17.52;SOR=3.258;VQSLOD=-32.6\"| __truncated__ \"AC=127;AF=0.0400126;AN=3174;BaseQRankSum=0.736;ClippingRankSum=0.736;DP=2750;FS=0;InbreedingCoeff=0.0015;MLEAC=\"| __truncated__ \"AC=128;AF=0.0352811;AN=3628;BaseQRankSum=0.736;ClippingRankSum=0.727;DP=3476;FS=0;InbreedingCoeff=-0.0015;MLEAC\"| __truncated__ \"AC=1;AF=0.000165837;AN=6030;BaseQRankSum=-0.583;ClippingRankSum=-0.259;DP=19530;FS=0;InbreedingCoeff=-0.0274;ML\"| __truncated__ ... #>  $ gt     : int [1:5, 1:3202] NA 2 2 0 0 0 NA NA 0 0 ... #>  - attr(*, \"class\")= chr \"vcftable\" res <- vcftable(rawvcf, \"chr21:1-5100000\", vartype = \"indels\", format = \"DP\", qual=100) vcfplot(res, which.sample = 10, ylim=c(0,60), col = 3, pch=19)"},{"path":"/index.html","id":"vcfcomp-compare-two-vcf-files-and-report-concordance","dir":"","previous_headings":"","what":"vcfcomp: compare two VCF files and report concordance","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"Want investigate concordance two VCF files? vcfcomp utility function need! example, benchmarkings, intend calculate genotype correlation test truth.  Also, want investigate relationship genotype concordance call rate ranked genotype quality.  Check vignettes !","code":"res <- vcfcomp(test = rawvcf, truth = phasedvcf,                stats = \"r2\", region = \"chr21:1-5100000\",                 formats = c(\"GT\",\"GT\"), setid = TRUE) par(mar=c(5,5,2,2), cex.lab = 2) vcfplot(res, col = 2,cex = 2, lwd = 3, type = \"b\") svvcf <- system.file(\"extdata\", \"platinum.sv.vcf.gz\", package=\"vcfppR\") svuppvcf <- system.file(\"extdata\", \"svupp.call.vcf.gz\", package=\"vcfppR\") truth <- vcftable(svvcf) truth$neighbors <-as.integer(sub(\".*NumNeighbors=([^;]+).*\", \"\\\\1\", truth$info)) truth <- subset(truth, neighbors == 0) ## subset biallelic SVs res <- vcfcomp(svuppvcf, truth, stats = \"gtgq\", region = \"chr1\") vcfplot(res, col = 2,cex = 2, lwd = 3, type = \"l\", bty = 'l')"},{"path":"/index.html","id":"vcfsummary-variants-characterization","dir":"","previous_headings":"","what":"vcfsummary: variants characterization","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"Want summarize variants discovered genotype caller e.g.¬†GATK? vcfsummary utility function need! Small variants  Complex structure variants","code":"res <- vcfsummary(rawvcf,\"chr21:10000000-10010000\") vcfplot(res, pop = popfile, col = 1:5, main = \"Number of SNP & INDEL variants\") res <- vcfsummary(svfile, svtype = TRUE, region = \"chr20\") vcfplot(res, main = \"Structure Variant Counts\", col = 1:7)"},{"path":"/index.html","id":"r-api-of-vcfpph","dir":"","previous_headings":"","what":"R API of vcfpp.h","title":"Rapid Manipulation of the Variant Call Format (VCF)","text":"two classes .e.¬†vcfreader vcfwriter offering full R-bindings vcfpp.h. Check examples tests folder refer manual, e.g.¬†?vcfppR::vcfreader.","code":"library(testthat) svfile <- system.file(\"extdata\", \"sv.vcf.gz\", package=\"vcfppR\") test_that(\"can change samples name and set genotypes for single sample\", {   br <- vcfreader$new(svfile, \"\", \"HG00096\")   br$variant()   expect_identical(br$infoStr(\"SVTYPE\"), \"DUP\")   expect_identical(br$genotypes(F), c(0L, 0L))   br$setGenotypes(c(1L,1L))   expect_identical(br$genotypes(F), c(1L, 1L))   outfile <- paste0(tempfile(), \".vcf.gz\")   br$output(outfile)   br$updateSamples(\"ZZZZZ\")   br$write()   br$close()   vcf <- vcftable(outfile)   expect_true(vcf$gt==2)   expect_true(vcf$samples==\"ZZZZZ\") }) #> Test passed üéâ"},{"path":"/reference/subset.vcftable.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset a vcftable object ‚Äî subset.vcftable","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"S3 method subsetting vcftable objects rows (variants) columns (fields). Allows filtering variants based logical conditions selecting specific fields.","code":""},{"path":"/reference/subset.vcftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"","code":"# S3 method for class 'vcftable' subset(x, subset, select, drop = FALSE, ...)"},{"path":"/reference/subset.vcftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"x vcftable object returned vcftable subset logical expression indicating variants (rows) keep. expression evaluated context vcftable object, allowing direct reference fields like chr, pos, ref, alt, qual, etc. Missing values treated FALSE. select expression indicating fields (columns) select. omitted, fields except samples selected. Note: samples field always kept selected/deselected. drop logical. TRUE, result coerced lowest possible dimension. Passed [ operator subsetting. Default FALSE. ... Currently used can avoid S3 generic consistency warnings","code":""},{"path":"/reference/subset.vcftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"vcftable object selected variants fields.","code":""},{"path":"/reference/subset.vcftable.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/subset.vcftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Subset a vcftable object ‚Äî subset.vcftable","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcftable(vcffile, \"chr21:1-5050000\")  # Subset by quality score high_qual <- subset(res, qual > 100)  # Subset by position and select specific fields region_subset <- subset(res, pos >= 5000000 & pos <= 5010000,                         select = c(chr, pos, ref, alt))  region_subset <- subset(res, pos >= 5000000 & pos <= 5030400,                         select = c(chr, pos, ref, alt))  # Subset SNPs (REF and ALT are single nucleotides) snps <- subset(res, nchar(ref) == 1 & nchar(alt) == 1)"},{"path":"/reference/vcfcomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"Compare two VCF/BCF files reporting various statistics","code":""},{"path":"/reference/vcfcomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"","code":"vcfcomp(   test,   truth,   formats = c(\"DS\", \"GT\"),   stats = \"r2\",   by.sample = FALSE,   by.variant = FALSE,   flip = FALSE,   names = NULL,   bins = NULL,   af = NULL,   out = NULL,   choose_random_start = FALSE,   return_pse_sites = FALSE,   ... )"},{"path":"/reference/vcfcomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"test path comparison file (test), can VCF/BCF file, vcftable object saved RDS file. truth path baseline file (truth), can VCF/BCF file, vcftable object saved RDS file. formats character vector. FORMAT tags extract test truth respectively. default c(\"DS\", \"GT\") extracts 'DS' test 'GT' truth. stats character. statistics calculated. Supports following options: \"r2\" Pearson correlation coefficient squared (default) \"f1\" F1-score, good balance sensitivity precision \"nrc\" Non-Reference Concordance rate \"pse\" Phasing Switch Error rate \"\" calculate r2, f1, nrc together \"gtgq\" genotype quality-based concordance analysis \"gtdp\" depth-based concordance analysis .sample logical. calculate sample-wise concordance, can stratified MAF bin. .variant logical. calculate variant-wise concordance, can stratified MAF bin. .sample .variant FALSE, calculations samples variants together bin. flip logical. flip ref alt variants names character vector. reset samples' names test VCF. bins numeric vector. break statistics allele frequency bins. NULL (default), bins automatically generated fine resolution rare variants coarser resolution common variants (ranging 0 0.5). af file path allele frequency RDS file saved object af. Format text file: space-separated text file five columns header named 'chr' 'pos' 'ref' 'alt' 'af'. NULL, allele frequencies calculated truth genotypes. output prefix saving objects RDS file. provided, creates three files: .af.rds, .test.rds, .truth.rds choose_random_start logical. choose random start stats=\"pse\". Defaults FALSE. return_pse_sites logical. return phasing switch error sites stats=\"pse\". Defaults FALSE. ... additional options passed vcftable, 'samples', 'region', 'pass'.","code":""},{"path":"/reference/vcfcomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"list object class \"vcfcomp\" containing: samples character vector sample names stats calculated statistics, named according 'stats' parameter. stats=\"\", returns r2, f1, nrc components.","code":""},{"path":"/reference/vcfcomp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"vcfcomp implements various statistics compare two VCF/BCF files, e.g. report genotype concordance, correlation stratified allele frequency.","code":""},{"path":"/reference/vcfcomp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfcomp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two VCF/BCF files reporting various statistics ‚Äî vcfcomp","text":"","code":"library('vcfppR') # site-wise comparision stratified by allele frequency test <- system.file(\"extdata\", \"imputed.gt.vcf.gz\", package=\"vcfppR\") truth <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") samples <- \"HG00673,NA10840\" res <- vcfcomp(test, truth, stats=\"r2\", bins=c(0,1), samples=samples, setid=TRUE) str(res)  # sample-wise comparision stratified by sample-level metrice e.g GQ test <- system.file(\"extdata\", \"svupp.call.vcf.gz\", package=\"vcfppR\") truth <- system.file(\"extdata\", \"platinum.sv.vcf.gz\", package=\"vcfppR\") res <- vcfcomp(test, truth, stats = \"gtgq\", region = \"chr1\") str(res)"},{"path":"/reference/vcfinfo.html","id":null,"dir":"Reference","previous_headings":"","what":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"read INFO tag VCF/BCF R data structure","code":""},{"path":"/reference/vcfinfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"","code":"vcfinfo(   vcffile,   tag,   region = \"\",   vartype = \"all\",   ids = NULL,   qual = 0,   pass = FALSE,   setid = FALSE )"},{"path":"/reference/vcfinfo.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"vcffile path VCF/BCF file tag INFO tag extract. region region subset bcftools-like style: \"chr1\", \"chr1:1-10000000\" vartype restrict specific type variants. supports \"snps\",\"indels\", \"sv\", \"multisnps\",\"multiallelics\" ids character vector. restrict sites ID given vector. default NULL filter sites. qual numeric. restrict variants QUAL > qual. pass logical. restrict variants FILTER = \"PASS\". setid logical. reset ID column CHR_POS_REF_ALT.","code":""},{"path":"/reference/vcfinfo.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"Return list containing following components: chr : character vector;  CHR column VCF file pos : character vector;  POS column VCF file id : character vector;  ID column VCF file ref : character vector;  REF column VCF file alt : character vector;  ALT column VCF file qual : character vector;  QUAL column VCF file filter : character vector;  FILTER column VCF file tag : vector either integer, numberic character values depending tag extract;  specifiy tag INFO column extracted","code":""},{"path":"/reference/vcfinfo.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"vcfinfo uses C++ API vcfpp, wrapper htslib, read VCF/BCF files. Thus, full functionalities htslib, restrict specific variant types, samples regions. memory efficiency reason, vcfinfo designed parse one tag time INFO column VCF. Currently support parsing vector values given INFO tag.","code":""},{"path":"/reference/vcfinfo.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfinfo.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"read a INFO tag in the VCF/BCF into R data structure ‚Äî vcfinfo","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcfinfo(vcffile, \"AF\", region = \"chr21:1-5050000\", vartype = \"snps\", pass = TRUE) str(res)"},{"path":"/reference/vcfplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Make sensible and beautiful plots based on various objects in vcfppR ‚Äî vcfplot","title":"Make sensible and beautiful plots based on various objects in vcfppR ‚Äî vcfplot","text":"Make sensible beautiful plots based various objects vcfppR","code":""},{"path":"/reference/vcfplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Make sensible and beautiful plots based on various objects in vcfppR ‚Äî vcfplot","text":"","code":"vcfplot(   obj,   which.sample = NULL,   which.format = 10,   variant = c(\"SNP\", \"INDEL\"),   pop = NULL,   ... )"},{"path":"/reference/vcfplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Make sensible and beautiful plots based on various objects in vcfppR ‚Äî vcfplot","text":"obj object returned vcftable, vcfcomp, vcfsummary .sample sample plotted. NULL aggregate samples. .format FORMAT field plotted. Defaults use 10-th names. variant types variant desired pop file contains population information ... parameters passed graphics","code":""},{"path":"/reference/vcfpopgen.html","id":null,"dir":"Reference","previous_headings":"","what":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"count heterozygous sites per sample VCF/BCF","code":""},{"path":"/reference/vcfpopgen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"","code":"vcfpopgen(   vcffile,   region = \"\",   samples = \"-\",   pass = FALSE,   qual = 0,   fun = \"heterozygosity\" )"},{"path":"/reference/vcfpopgen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"vcffile path VCF/BCF file region region subset like bcftools samples samples subset like bcftools pass restrict variants FILTER==PASS qual restrict variants QUAL > qual. fun popgen function run. available functions \"heterozygosity\".","code":""},{"path":"/reference/vcfpopgen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"vcfpopgen list containing following components: samples : character vector;  samples ids VCF file subsetting hets : integer vector;  counts heterozygous sites sample order samples","code":""},{"path":"/reference/vcfpopgen.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfpopgen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"count the heterozygous sites per sample in the VCF/BCF ‚Äî vcfpopgen","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcfpopgen(vcffile) str(res)"},{"path":"/reference/vcfppR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) ‚Äî vcfppR-package","title":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) ‚Äî vcfppR-package","text":"'vcfpp.h' (https://github.com/Zilong-Li/vcfpp) provides easy--use 'C++' 'API' 'htslib', offering full functionality manipulating Variant Call Format (VCF) files. 'vcfppR' package serves R bindings 'vcfpp.h' library, enabling rapid processing compressed uncompressed VCF files. Explore range powerful features efficient VCF data manipulation.","code":""},{"path":[]},{"path":"/reference/vcfppR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"vcfppR: Rapid Manipulation of the Variant Call Format (VCF) ‚Äî vcfppR-package","text":"Maintainer: Zilong Li zilong.dk@gmail.com (ORCID) contributors: Bonfield, James K Marshall, John Danecek, Petr Li, Heng Ohan, Valeriu Whitwham, Andrew Keane, Thomas Davies, Robert M (Authors included htslib library) [copyright holder]","code":""},{"path":"/reference/vcfreader.html","id":null,"dir":"Reference","previous_headings":"","what":"API for manipulating the VCF/BCF. ‚Äî vcfreader","title":"API for manipulating the VCF/BCF. ‚Äî vcfreader","text":"Type name class see details methods","code":""},{"path":"/reference/vcfreader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"API for manipulating the VCF/BCF. ‚Äî vcfreader","text":"C++ class following fields/methods manipulating VCF/BCF","code":""},{"path":"/reference/vcfreader.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"API for manipulating the VCF/BCF. ‚Äî vcfreader","text":"new Constructor given vcf file Parameter: vcffile - path vcf file new Constructor given vcf file region Parameter: vcffile - path vcf file Parameter: region - region constrained new Constructor given vcf file, region samples Parameter: vcffile - path vcf file Parameter: region - region constrained Parameter: samples - samples constrained. Comma separated list samples include (exclude \"^\" prefix). setRegion try set specific region work . throw errors index region found. Use getStatus check region valid empty! getStatus return 1: region valid empty. 0: region valid empty. -1: index file. -2: region found invalid region form variant Try get next variant record. return FALSE variants hit end file, otherwise TRUE. chr Return CHROM field current variant pos Return POS field current variant id Return CHROM field current variant ref Return REF field current variant alt Return ALT field current variant qual Return QUAL field current variant filter Return FILTER field current variant info Return INFO field current variant infoInt Return tag value integer type INFO field current variant Parameter: tag - tag name retrieve INFO infoFloat Return tag value float type INFO field current variant Parameter: tag - tag name retrieve INFO infoStr Return tag value string type INFO field current variant Parameter: tag - tag name retrieve INFO infoIntVec Return tag value vector integer type INFO field current variant Parameter: tag - tag name retrieve INFO infoFloatVec Return tag value vector float type INFO field current variant Parameter: tag - tag name retrieve INFO genotypes Return genotype values vector integers Parameter: collapse - Boolean value indicates wheather collapse size genotypes, eg, return diploid genotypes. formatInt Return tag value integer type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT formatFloat Return tag value float type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT formatStr Return tag value string type sample FORAMT field current variant Parameter: tag - tag name retrieve FORAMT isSNP Test current variant exculsively SNP isIndel Test current variant exculsively INDEL isSV Test current variant exculsively SV isMultiAllelics Test current variant exculsively Multi Allelics isMultiAllelicSNP Test current variant exculsively Multi Biallelics (SNPs) hasSNP Test current variant SNP hasINDEL Test current variant INDEL hasINS Test current variant INS hasDEL Test current variant DEL hasMNP Test current variant MNP hasBND Test current variant BND hasOTHER Test current variant hasOVERLAP Test current variant OVERLAP nsamples Return number samples samples Return vector samples id header Return raw string vcf header string Return raw string current variant including newline line Return raw string current variant without newline output Init output object streaming variants another vcf updateSamples update samples name output VCF Parameter: s - comma-seperated string new samples names write Streaming current variant output vcf close Close connection output vcf setCHR Modify CHR current variant Parameter: s - string CHR setID Modify ID current variant Parameter: s - string ID setPOS Modify POS current variant Parameter: pos - integer POS setRefAlt Modify REF ALT current variant Parameter: s - string reperated comma setInfoInt Modify given tag INT type INFO current variant Parameter: tag - string tag name Parameter: v - integer tag value setInfoFloat Modify given tag FLOAT type INFO current variant Parameter: tag - string tag name Parameter: v - double tag value setInfoStr Modify given tag STRING type INFO current variant Parameter: tag - string tag name Parameter: s - string tag value setPhasing Modify phasing status sample Parameter: v - integer vector size number samples. 1s 0s valid. setGenotypes Modify genotypes current variant Parameter: v - integer vector genotypes. Use NA -9 missing value. setFormatInt Modify given tag INT type FORMAT current variant Parameter: tag - string tag name Parameter: v - integer tag value setFormatFloat Modify given tag FLOAT type FORMAT current variant Parameter: tag - string tag name Parameter: v - double tag value setFormatStr Modify given tag STRING type FORMAT current variant Parameter: tag - string tag name Parameter: s - string tag value rmInfoTag Remove given tag INFO current variant Parameter: s - string tag name rmFormatTag Remove given tag FORMAT current variant Parameter: s - string tag name setVariant Modify current variant adding vcf line Parameter: s - string one line VCF addINFO Add INFO header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addFORMAT Add FORMAT header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means","code":""},{"path":"/reference/vcfreader.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"API for manipulating the VCF/BCF. ‚Äî vcfreader","text":"","code":"vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") br <- vcfreader$new(vcffile) res <- rep(0L, br$nsamples()) while(br$variant()) {   if(br$isSNP()) {   gt <- br$genotypes(TRUE) == 1   gt[is.na(gt)] <- FALSE   res <- res + gt   } }"},{"path":"/reference/vcfsummary.html","id":null,"dir":"Reference","previous_headings":"","what":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"summarize various variant types variant level sample level.","code":""},{"path":"/reference/vcfsummary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"","code":"vcfsummary(   vcffile,   region = \"\",   samples = \"-\",   pass = FALSE,   qual = 0,   svtype = FALSE )"},{"path":"/reference/vcfsummary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"vcffile path VCF/BCF file region region subset like bcftools samples samples subset like bcftools pass restrict variants FILTER==PASS qual restrict variants QUAL > qual. svtype summarize variants SVTYPE","code":""},{"path":"/reference/vcfsummary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"vcfsummary list containing following components: summary : named integer vector;  summarize counts variant type samples : character vector;  samples ids VCF file subsetting vartype : integer vector;  counts variant type sample level order samples","code":""},{"path":"/reference/vcfsummary.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"bcftools view -s \"id01,id02\" input.bcf.gz chr1:100000-20000","code":""},{"path":"/reference/vcfsummary.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcfsummary.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"summarize the various variant types at both variant level and sample level. ‚Äî vcfsummary","text":"","code":"library('vcfppR') svfile <- system.file(\"extdata\", \"sv.vcf.gz\", package=\"vcfppR\") res <- vcfsummary(svfile, region = \"chr21:1-10000000\", svtype = TRUE) str(res)"},{"path":"/reference/vcftable.html","id":null,"dir":"Reference","previous_headings":"","what":"read VCF/BCF contents into R data structure ‚Äî vcftable","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"swiss army knife reading VCF/BCF R data types rapidly easily.","code":""},{"path":"/reference/vcftable.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"","code":"vcftable(   vcffile,   region = \"\",   samples = \"-\",   vartype = \"all\",   format = \"GT\",   ids = NULL,   qual = 0,   pass = FALSE,   info = TRUE,   collapse = TRUE,   setid = FALSE,   mac = 0,   rmdup = FALSE )"},{"path":"/reference/vcftable.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"vcffile path VCF/BCF file region region subset bcftools-like style: \"chr1\", \"chr1:1-10000000\" samples samples subset bcftools-like style. comma separated list samples include (exclude \"^\" prefix). e.g. \"id01,id02\", \"^id01,id02\". vartype restrict specific type variants. supports \"snps\",\"indels\", \"sv\", \"multisnps\",\"multiallelics\" format FORMAT tag extract. default \"GT\" extracted. ids character vector. restrict sites ID given vector. default NULL filter sites. qual numeric. restrict variants QUAL > qual. pass logical. restrict variants FILTER = \"PASS\". info logical. drop INFO column returned list. collapse logical. acts FORMAT. FORMAT extract \"GT\", dim raw genotypes matrix diploid (M, 2 * N), M #markers N #samples. default TRUE collapse genotypes sample matrix (M, N). Set FALSE one wants maintain phasing order, e.g. \"1|0\" parsed c(1, 0) collapse=FALSE. FORMAT extract \"GT\", collapse=TRUE try turn list extracted vector matrix. However, raises issues one variant mutliallelic resulting vaules others. setid logical. reset ID column CHR_POS_REF_ALT. mac integer. restrict variants minor allele count higher value. rmdup logical. remove duplicated sites keeping first occurrence POS. (default: FALSE)","code":""},{"path":"/reference/vcftable.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"Return list containing following components: samples : character vector;  samples ids VCF file subsetting chr : character vector;  CHR column VCF file pos : character vector;  POS column VCF file id : character vector;  ID column VCF file ref : character vector;  REF column VCF file alt : character vector;  ALT column VCF file qual : character vector;  QUAL column VCF file filter : character vector;  FILTER column VCF file info : character vector;  INFO column VCF file format : matrix either integer numberic values depending tag extract;  specifiy tag FORMAT column extracted","code":""},{"path":"/reference/vcftable.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"vcftable uses C++ API vcfpp, wrapper htslib, read VCF/BCF files. Thus, full functionalities htslib, restrict specific variant types, samples regions. memory efficiency reason, vcftable designed parse one tag time FORMAT column VCF. default, matrix genotypes, .e. \"GT\" tag, returned vcftable, many tags supported format option.","code":""},{"path":"/reference/vcftable.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"Zilong Li zilong.dk@gmail.com","code":""},{"path":"/reference/vcftable.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"read VCF/BCF contents into R data structure ‚Äî vcftable","text":"","code":"library('vcfppR') vcffile <- system.file(\"extdata\", \"raw.gt.vcf.gz\", package=\"vcfppR\") res <- vcftable(vcffile, \"chr21:1-5050000\", vartype = \"snps\") str(res)"},{"path":"/reference/vcfwriter.html","id":null,"dir":"Reference","previous_headings":"","what":"API for writing the VCF/BCF. ‚Äî vcfwriter","title":"API for writing the VCF/BCF. ‚Äî vcfwriter","text":"Type name class see details methods","code":""},{"path":"/reference/vcfwriter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"API for writing the VCF/BCF. ‚Äî vcfwriter","text":"C++ class following fields/methods writing VCF/BCF","code":""},{"path":"/reference/vcfwriter.html","id":"fields","dir":"Reference","previous_headings":"","what":"Fields","title":"API for writing the VCF/BCF. ‚Äî vcfwriter","text":"new Constructor given vcf file Parameter: vcffile - path vcf file. start \"~\" Parameter: version - version VCF specification addContig Add Contig header vcf Parameter: str - string CONTIG name addFILTER Add FILTER header vcf Parameter: id - string FILTER name Parameter: desc - string description means addINFO Add INFO header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addFORMAT Add FORMAT header vcf Parameter: id - string tag name Parameter: number - string number Parameter: type - string type Parameter: desc - string description means addSample Add SAMPLE header vcf Parameter: str - string SAMPLE name addLine Add line header vcf Parameter: str - string line header VCF writeline Write variant record given line Parameter: line - string line variant VCF. ended \"newline\" close Close save vcf file","code":""},{"path":"/reference/vcfwriter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"API for writing the VCF/BCF. ‚Äî vcfwriter","text":"","code":"outvcf <- file.path(paste0(tempfile(), \".vcf.gz\")) bw <- vcfwriter$new(outvcf, \"VCF4.1\") bw$addContig(\"chr20\") bw$addFORMAT(\"GT\", \"1\", \"String\", \"Genotype\"); bw$addSample(\"NA12878\") s1 <- \"chr20\\t2006060\\t.\\tG\\tC\\t100\\tPASS\\t.\\tGT\\t1|0\" bw$writeline(s1) bw$close()"},{"path":"/news/index.html","id":"vcfppr-081","dir":"Changelog","previous_headings":"","what":"vcfppR 0.8.1","title":"vcfppR 0.8.1","text":"CRAN release: 2025-08-25 remove unused code vcfpp.h vcfcomp: rename col name ‚Äúconcordance‚Äù ‚Äúaccuracy‚Äù","code":""},{"path":"/news/index.html","id":"vcfppr-080","dir":"Changelog","previous_headings":"","what":"vcfppR 0.8.0","title":"vcfppR 0.8.0","text":"CRAN release: 2025-07-02 copy static libs libs folder","code":""},{"path":"/news/index.html","id":"vcfppr-076","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.6","title":"vcfppR 0.7.6","text":"CRAN release: 2025-03-31 fix CRAN notes","code":""},{"path":"/news/index.html","id":"vcfppr-075","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.5","title":"vcfppR 0.7.5","text":"fix issue #14 handle libdeflate dependency linux","code":""},{"path":"/news/index.html","id":"vcfppr-074","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.4","title":"vcfppR 0.7.4","text":"fix issue #13 speedup setRegion","code":""},{"path":"/news/index.html","id":"vcfppr-073","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.3","title":"vcfppR 0.7.3","text":"enable libdeflate linux","code":""},{"path":"/news/index.html","id":"vcfppr-072","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.2","title":"vcfppR 0.7.2","text":"make htslib available including linking packages","code":""},{"path":"/news/index.html","id":"vcfppr-070","dir":"Changelog","previous_headings":"","what":"vcfppR 0.7.0","title":"vcfppR 0.7.0","text":"CRAN release: 2024-12-21 fix parsing BCF subsetting sample ids genomic region time fix vcfcomp stats=\"nrc\" input vectors different length use latest version htslib v1.21 reduce size installation","code":""},{"path":"/news/index.html","id":"vcfppr-060","dir":"Changelog","previous_headings":"","what":"vcfppR 0.6.0","title":"vcfppR 0.6.0","text":"CRAN release: 2024-09-29 upgrade vcfpp.h v0.6.0 new API vcfreader$setRegion new API vcfreader$getStatus","code":""},{"path":"/news/index.html","id":"vcfppr-050","dir":"Changelog","previous_headings":"","what":"vcfppR 0.5.0","title":"vcfppR 0.5.0","text":"CRAN release: 2024-09-22 upgrade vcfpp.h v0.5.1 add bcfreader$updateSamples() function vcfcomp: can take vcftable object input vcfcomp: defaults changed setid=FALSE bug fix","code":""},{"path":"/news/index.html","id":"vcfppr-046","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.6","title":"vcfppR 0.4.6","text":"CRAN release: 2024-05-24 add vcfplot function fix bug vcftable FORMAT unaligned list add vignette vcfcomp","code":""},{"path":"/news/index.html","id":"vcfppr-045","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.5","title":"vcfppR 0.4.5","text":"CRAN release: 2024-04-08 add vcfcomp function fix memory leaks pass ASAN check","code":""},{"path":"/news/index.html","id":"vcfppr-040","dir":"Changelog","previous_headings":"","what":"vcfppR 0.4.0","title":"vcfppR 0.4.0","text":"CRAN release: 2024-02-26 add setid option vcftable patches upcoming Rtools windows","code":""},{"path":"/news/index.html","id":"vcfppr-038","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.8","title":"vcfppR 0.3.8","text":"CRAN release: 2024-01-14 fix issues M1 Mac","code":""},{"path":"/news/index.html","id":"vcfppr-037","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.7","title":"vcfppR 0.3.7","text":"add vcfreader@rmFormatTag() add vcfreader@samples() vcftable supports vartype = ‚Äòsv‚Äô","code":""},{"path":"/news/index.html","id":"vcfppr-036","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.6","title":"vcfppR 0.3.6","text":"add vcfreader::line remove vcfreader::setVariant bug fix setFormatStr units tests","code":""},{"path":"/news/index.html","id":"vcfppr-035","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.5","title":"vcfppR 0.3.5","text":"CRAN release: 2023-12-14 add vcfreader vcfwriter","code":""},{"path":"/news/index.html","id":"vcfppr-034","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.4","title":"vcfppR 0.3.4","text":"support filters variant ID","code":""},{"path":"/news/index.html","id":"vcfppr-033","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.3","title":"vcfppR 0.3.3","text":"use API vcfpp.h v0.3.1 set missing vaules FORMAT NA support filters QUAL, FILTER INFO","code":""},{"path":"/news/index.html","id":"vcfppr-030","dir":"Changelog","previous_headings":"","what":"vcfppR 0.3.0","title":"vcfppR 0.3.0","text":"First release using vcfpp.h v0.3.0 add vcftable function add vcfsummary function add vcfpopgen function","code":""}]
